var cov_gqjmwbqc4=function(){var path='/home/ubuntu/Bureau/S2IMA/ProjetLPMP3/groupeMP3/groupeMP3/server.js',hash='a705af32fe794ce6c70cc77498834775e548d796',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/ubuntu/Bureau/S2IMA/ProjetLPMP3/groupeMP3/groupeMP3/server.js',statementMap:{'0':{start:{line:1,column:14},end:{line:1,column:32}},'1':{start:{line:2,column:18},end:{line:2,column:44}},'2':{start:{line:3,column:21},end:{line:3,column:50}},'3':{start:{line:4,column:18},end:{line:4,column:43}},'4':{start:{line:5,column:18},end:{line:5,column:43}},'5':{start:{line:6,column:4},end:{line:12,column:60}},'6':{start:{line:13,column:10},end:{line:13,column:19}},'7':{start:{line:14,column:11},end:{line:14,column:26}},'8':{start:{line:15,column:13},end:{line:15,column:30}},'9':{start:{line:16,column:19},end:{line:16,column:43}},'10':{start:{line:17,column:17},end:{line:17,column:46}},'11':{start:{line:19,column:0},end:{line:19,column:41}},'12':{start:{line:21,column:0},end:{line:21,column:23}},'13':{start:{line:22,column:0},end:{line:22,column:24}},'14':{start:{line:23,column:0},end:{line:23,column:49}},'15':{start:{line:24,column:0},end:{line:24,column:24}},'16':{start:{line:25,column:0},end:{line:25,column:22}},'17':{start:{line:27,column:0},end:{line:46,column:3}},'18':{start:{line:29,column:24},end:{line:29,column:45}},'19':{start:{line:30,column:20},end:{line:30,column:37}},'20':{start:{line:31,column:2},end:{line:44,column:3}},'21':{start:{line:34,column:17},end:{line:34,column:41}},'22':{start:{line:35,column:4},end:{line:35,column:51}},'23':{start:{line:36,column:4},end:{line:36,column:67}},'24':{start:{line:37,column:4},end:{line:37,column:58}},'25':{start:{line:38,column:4},end:{line:38,column:31}},'26':{start:{line:43,column:4},end:{line:43,column:50}},'27':{start:{line:45,column:2},end:{line:45,column:9}},'28':{start:{line:48,column:0},end:{line:48,column:48}},'29':{start:{line:49,column:0},end:{line:49,column:56}},'30':{start:{line:50,column:0},end:{line:50,column:43}},'31':{start:{line:51,column:0},end:{line:51,column:31}},'32':{start:{line:54,column:0},end:{line:54,column:40}},'33':{start:{line:55,column:0},end:{line:55,column:45}},'34':{start:{line:56,column:0},end:{line:56,column:42}},'35':{start:{line:57,column:0},end:{line:57,column:51}},'36':{start:{line:58,column:0},end:{line:58,column:48}},'37':{start:{line:61,column:0},end:{line:61,column:47}},'38':{start:{line:64,column:0},end:{line:64,column:49}},'39':{start:{line:65,column:0},end:{line:65,column:52}},'40':{start:{line:68,column:0},end:{line:68,column:53}},'41':{start:{line:72,column:0},end:{line:72,column:26}},'42':{start:{line:73,column:0},end:{line:73,column:31}},'43':{start:{line:74,column:0},end:{line:74,column:38}},'44':{start:{line:75,column:0},end:{line:75,column:33}},'45':{start:{line:76,column:0},end:{line:76,column:31}},'46':{start:{line:77,column:0},end:{line:77,column:35}},'47':{start:{line:78,column:0},end:{line:78,column:33}},'48':{start:{line:79,column:0},end:{line:79,column:33}},'49':{start:{line:80,column:0},end:{line:80,column:47}},'50':{start:{line:81,column:0},end:{line:81,column:47}},'51':{start:{line:82,column:12},end:{line:82,column:28}},'52':{start:{line:83,column:0},end:{line:83,column:41}},'53':{start:{line:84,column:0},end:{line:84,column:24}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:27,column:8},end:{line:27,column:9}},loc:{start:{line:27,column:30},end:{line:46,column:1}},line:27}},branchMap:{'0':{loc:{start:{line:31,column:2},end:{line:44,column:3}},type:'if',locations:[{start:{line:31,column:2},end:{line:44,column:3}},{start:{line:31,column:2},end:{line:44,column:3}}],line:31},'1':{loc:{start:{line:31,column:5},end:{line:31,column:63}},type:'binary-expr',locations:[{start:{line:31,column:5},end:{line:31,column:34}},{start:{line:31,column:38},end:{line:31,column:63}}],line:31}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0},f:{'0':0},b:{'0':[0,0],'1':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var express=(cov_gqjmwbqc4.s[0]++,require('express')),plagesRoute=(cov_gqjmwbqc4.s[1]++,require('./routes/plages')),affichageRoute=(cov_gqjmwbqc4.s[2]++,require('./routes/affichage')),indexRouter=(cov_gqjmwbqc4.s[3]++,require('./routes/index')),usersRouter=(cov_gqjmwbqc4.s[4]++,require('./routes/users'));cov_gqjmwbqc4.s[5]++;uploadRouter=require('./routes/upload'),listeRouter=require('./routes/liste'),lecteurRouter=require('./routes/lecteur'),liste2Router=require('./routes/liste2'),liste3Router=require('./routes/liste3'),ajoutPlaylistRouter=require('./routes/ajoutPlaylist'),listePlaylistRouter=require('./routes/listePlaylist');var app=(cov_gqjmwbqc4.s[6]++,express());var path=(cov_gqjmwbqc4.s[7]++,require('path'));var logger=(cov_gqjmwbqc4.s[8]++,require('morgan'));var cookieParser=(cov_gqjmwbqc4.s[9]++,require('cookie-parser'));var fileUpload=(cov_gqjmwbqc4.s[10]++,require('express-fileupload'));cov_gqjmwbqc4.s[11]++;global.appRoot=path.resolve(__dirname);cov_gqjmwbqc4.s[12]++;app.use(logger('dev'));cov_gqjmwbqc4.s[13]++;app.use(express.json());cov_gqjmwbqc4.s[14]++;app.use(express.urlencoded({extended:false}));cov_gqjmwbqc4.s[15]++;app.use(cookieParser());cov_gqjmwbqc4.s[16]++;app.use(fileUpload());cov_gqjmwbqc4.s[17]++;app.use(function(req,res,next){cov_gqjmwbqc4.f[0]++;// cookie existant clientside ?
var cookieGroupeMP3=(cov_gqjmwbqc4.s[18]++,req.cookies.groupeMP3);var cookieLikes=(cov_gqjmwbqc4.s[19]++,req.cookies.likes);cov_gqjmwbqc4.s[20]++;if((cov_gqjmwbqc4.b[1][0]++,cookieGroupeMP3===undefined)||(cov_gqjmwbqc4.b[1][1]++,cookieLikes===undefined)){cov_gqjmwbqc4.b[0][0]++;// NON
// création du cookie
var randNumb=(cov_gqjmwbqc4.s[21]++,Math.random().toString());cov_gqjmwbqc4.s[22]++;randNumb=randNumb.substring(2,randNumb.length);cov_gqjmwbqc4.s[23]++;res.cookie('groupeMP3',randNumb,{maxAge:900000,httpOnly:true});cov_gqjmwbqc4.s[24]++;res.cookie('likes','',{maxAge:900000,httpOnly:false});cov_gqjmwbqc4.s[25]++;console.log("cookie créé");}else{cov_gqjmwbqc4.b[0][1]++;cov_gqjmwbqc4.s[26]++;// OUI
//cookie existant
console.log("cookie existe",cookieGroupeMP3);}cov_gqjmwbqc4.s[27]++;next();});cov_gqjmwbqc4.s[28]++;app.set('views',path.join(__dirname,'views'));cov_gqjmwbqc4.s[29]++;app.use(express.static(path.join(__dirname,'public')));// dossier où le framework va chercher les ressources
cov_gqjmwbqc4.s[30]++;app.use(express.static(appRoot+'/files/'));// second dossier
cov_gqjmwbqc4.s[31]++;app.set('view engine','jade');// API REST
cov_gqjmwbqc4.s[32]++;app.get('/plages',plagesRoute.findAll);cov_gqjmwbqc4.s[33]++;app.get('/plages/:id',plagesRoute.findById);cov_gqjmwbqc4.s[34]++;app.post('/plages',plagesRoute.addPlage);cov_gqjmwbqc4.s[35]++;app.delete('/plages/:id',plagesRoute.deletePlage);cov_gqjmwbqc4.s[36]++;app.put('/plages/:id',plagesRoute.updatePlage);// AJOUT RESTFUL PLAYLIST
cov_gqjmwbqc4.s[37]++;app.post('/playlist',plagesRoute.addPlaylist);// INCREMENT/DECREMENT likes
cov_gqjmwbqc4.s[38]++;app.post('/like/:id',plagesRoute.likeIncrement);cov_gqjmwbqc4.s[39]++;app.post('/dislike/:id',plagesRoute.likeDecrement);// INCREMENT/DECREMENT écoutes
cov_gqjmwbqc4.s[40]++;app.post('/listen/:id',plagesRoute.listenIncrement);// PAGES
cov_gqjmwbqc4.s[41]++;app.use('/',indexRouter);cov_gqjmwbqc4.s[42]++;app.use('/users',usersRouter);cov_gqjmwbqc4.s[43]++;app.use('/affichage',affichageRoute);// plateforme de test CRUD
cov_gqjmwbqc4.s[44]++;app.use('/upload',uploadRouter);// plateforme d'administration pour ajout par upload de mp3
cov_gqjmwbqc4.s[45]++;app.use('/liste',listeRouter);// liste redirigeant l'utilisateur vers le lecteur
cov_gqjmwbqc4.s[46]++;app.use('/lecteur',lecteurRouter);// le lecteur
cov_gqjmwbqc4.s[47]++;app.use('/liste2',liste2Router);// liste contenant une iframe du lecteur en fonction de la musique écoutée
cov_gqjmwbqc4.s[48]++;app.use('/liste3',liste3Router);// liste requêtant les informations de la musique à écouter en ajax
cov_gqjmwbqc4.s[49]++;app.use('/ajoutPlaylist',ajoutPlaylistRouter);cov_gqjmwbqc4.s[50]++;app.use('/listePlaylist',listePlaylistRouter);var server=(cov_gqjmwbqc4.s[51]++,app.listen(3000));cov_gqjmwbqc4.s[52]++;console.log('Listening on port 3000...');cov_gqjmwbqc4.s[53]++;module.exports=server;