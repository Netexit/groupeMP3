var cov_2pxjvq39wa=function(){var path='/home/ubuntu/Bureau/S2IMA/ProjetLPMP3/groupeMP3/groupeMP3/routes/plages.js',hash='0ee4db2e1a5f5ecd7ad74e8befecf2dd5795dd09',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/ubuntu/Bureau/S2IMA/ProjetLPMP3/groupeMP3/groupeMP3/routes/plages.js',statementMap:{'0':{start:{line:2,column:12},end:{line:2,column:30}},'1':{start:{line:3,column:9},end:{line:3,column:34}},'2':{start:{line:4,column:9},end:{line:4,column:22}},'3':{start:{line:6,column:13},end:{line:6,column:25}},'4':{start:{line:7,column:9},end:{line:7,column:17}},'5':{start:{line:8,column:18},end:{line:8,column:35}},'6':{start:{line:11,column:0},end:{line:18,column:3}},'7':{start:{line:12,column:2},end:{line:17,column:3}},'8':{start:{line:13,column:4},end:{line:13,column:31}},'9':{start:{line:16,column:4},end:{line:16,column:26}},'10':{start:{line:20,column:0},end:{line:26,column:2}},'11':{start:{line:21,column:2},end:{line:25,column:5}},'12':{start:{line:22,column:4},end:{line:24,column:7}},'13':{start:{line:23,column:6},end:{line:23,column:22}},'14':{start:{line:28,column:0},end:{line:39,column:2}},'15':{start:{line:29,column:11},end:{line:29,column:24}},'16':{start:{line:30,column:2},end:{line:30,column:41}},'17':{start:{line:31,column:2},end:{line:38,column:5}},'18':{start:{line:33,column:16},end:{line:33,column:46}},'19':{start:{line:34,column:4},end:{line:37,column:7}},'20':{start:{line:35,column:6},end:{line:35,column:24}},'21':{start:{line:36,column:6},end:{line:36,column:21}},'22':{start:{line:41,column:0},end:{line:102,column:1}},'23':{start:{line:43,column:11},end:{line:43,column:24}},'24':{start:{line:44,column:11},end:{line:44,column:28}},'25':{start:{line:45,column:15},end:{line:45,column:33}},'26':{start:{line:46,column:2},end:{line:100,column:3}},'27':{start:{line:47,column:4},end:{line:96,column:7}},'28':{start:{line:49,column:20},end:{line:49,column:66}},'29':{start:{line:51,column:28},end:{line:51,column:90}},'30':{start:{line:52,column:6},end:{line:52,column:59}},'31':{start:{line:53,column:16},end:{line:65,column:7}},'32':{start:{line:66,column:6},end:{line:91,column:9}},'33':{start:{line:67,column:8},end:{line:73,column:11}},'34':{start:{line:68,column:10},end:{line:72,column:11}},'35':{start:{line:69,column:12},end:{line:69,column:56}},'36':{start:{line:71,column:12},end:{line:71,column:33}},'37':{start:{line:74,column:8},end:{line:77,column:11}},'38':{start:{line:75,column:10},end:{line:76,column:22}},'39':{start:{line:76,column:12},end:{line:76,column:22}},'40':{start:{line:78,column:8},end:{line:83,column:9}},'41':{start:{line:79,column:10},end:{line:82,column:13}},'42':{start:{line:80,column:12},end:{line:81,column:47}},'43':{start:{line:81,column:14},end:{line:81,column:47}},'44':{start:{line:84,column:8},end:{line:89,column:9}},'45':{start:{line:85,column:10},end:{line:88,column:13}},'46':{start:{line:86,column:12},end:{line:87,column:24}},'47':{start:{line:87,column:14},end:{line:87,column:24}},'48':{start:{line:90,column:8},end:{line:90,column:53}},'49':{start:{line:95,column:6},end:{line:95,column:33}},'50':{start:{line:99,column:4},end:{line:99,column:53}},'51':{start:{line:104,column:0},end:{line:118,column:1}},'52':{start:{line:105,column:11},end:{line:105,column:24}},'53':{start:{line:106,column:2},end:{line:106,column:39}},'54':{start:{line:107,column:2},end:{line:117,column:5}},'55':{start:{line:108,column:16},end:{line:108,column:46}},'56':{start:{line:109,column:4},end:{line:116,column:7}},'57':{start:{line:110,column:6},end:{line:115,column:7}},'58':{start:{line:111,column:8},end:{line:111,column:61}},'59':{start:{line:113,column:8},end:{line:113,column:58}},'60':{start:{line:114,column:8},end:{line:114,column:27}},'61':{start:{line:120,column:0},end:{line:136,column:1}},'62':{start:{line:121,column:11},end:{line:121,column:24}},'63':{start:{line:122,column:14},end:{line:122,column:22}},'64':{start:{line:123,column:2},end:{line:123,column:39}},'65':{start:{line:124,column:2},end:{line:135,column:5}},'66':{start:{line:125,column:16},end:{line:125,column:46}},'67':{start:{line:126,column:4},end:{line:134,column:7}},'68':{start:{line:127,column:6},end:{line:133,column:7}},'69':{start:{line:128,column:8},end:{line:128,column:52}},'70':{start:{line:129,column:8},end:{line:129,column:52}},'71':{start:{line:131,column:8},end:{line:131,column:58}},'72':{start:{line:132,column:8},end:{line:132,column:24}},'73':{start:{line:138,column:0},end:{line:144,column:1}},'74':{start:{line:139,column:2},end:{line:143,column:5}},'75':{start:{line:140,column:4},end:{line:142,column:7}},'76':{start:{line:141,column:6},end:{line:141,column:22}},'77':{start:{line:146,column:0},end:{line:152,column:1}},'78':{start:{line:147,column:2},end:{line:151,column:5}},'79':{start:{line:148,column:4},end:{line:150,column:7}},'80':{start:{line:149,column:6},end:{line:149,column:22}},'81':{start:{line:154,column:0},end:{line:161,column:1}},'82':{start:{line:155,column:2},end:{line:160,column:5}},'83':{start:{line:156,column:16},end:{line:156,column:46}},'84':{start:{line:157,column:4},end:{line:159,column:7}},'85':{start:{line:158,column:6},end:{line:158,column:21}},'86':{start:{line:163,column:0},end:{line:179,column:1}},'87':{start:{line:164,column:13},end:{line:164,column:15}},'88':{start:{line:165,column:2},end:{line:178,column:5}},'89':{start:{line:166,column:16},end:{line:166,column:46}},'90':{start:{line:167,column:4},end:{line:177,column:7}},'91':{start:{line:168,column:6},end:{line:168,column:36}},'92':{start:{line:169,column:6},end:{line:171,column:9}},'93':{start:{line:170,column:8},end:{line:170,column:35}},'94':{start:{line:172,column:6},end:{line:176,column:9}},'95':{start:{line:173,column:8},end:{line:175,column:11}},'96':{start:{line:174,column:10},end:{line:174,column:26}},'97':{start:{line:181,column:0},end:{line:190,column:1}},'98':{start:{line:182,column:2},end:{line:189,column:5}},'99':{start:{line:183,column:6},end:{line:188,column:9}},'100':{start:{line:184,column:8},end:{line:187,column:31}},'101':{start:{line:185,column:10},end:{line:185,column:54}},'102':{start:{line:187,column:10},end:{line:187,column:31}},'103':{start:{line:192,column:0},end:{line:202,column:1}},'104':{start:{line:193,column:2},end:{line:201,column:5}},'105':{start:{line:194,column:16},end:{line:194,column:57}},'106':{start:{line:195,column:4},end:{line:200,column:7}},'107':{start:{line:196,column:6},end:{line:199,column:21}},'108':{start:{line:197,column:8},end:{line:197,column:25}},'109':{start:{line:199,column:8},end:{line:199,column:21}},'110':{start:{line:204,column:0},end:{line:214,column:1}},'111':{start:{line:205,column:2},end:{line:213,column:5}},'112':{start:{line:206,column:16},end:{line:206,column:57}},'113':{start:{line:207,column:4},end:{line:212,column:7}},'114':{start:{line:208,column:6},end:{line:211,column:21}},'115':{start:{line:209,column:8},end:{line:209,column:25}},'116':{start:{line:211,column:8},end:{line:211,column:21}},'117':{start:{line:216,column:0},end:{line:226,column:1}},'118':{start:{line:217,column:2},end:{line:225,column:5}},'119':{start:{line:218,column:16},end:{line:218,column:57}},'120':{start:{line:219,column:4},end:{line:224,column:7}},'121':{start:{line:220,column:6},end:{line:223,column:21}},'122':{start:{line:221,column:8},end:{line:221,column:25}},'123':{start:{line:223,column:8},end:{line:223,column:21}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:11,column:98},end:{line:11,column:99}},loc:{start:{line:11,column:114},end:{line:18,column:1}},line:11},'1':{name:'(anonymous_1)',decl:{start:{line:20,column:18},end:{line:20,column:19}},loc:{start:{line:20,column:37},end:{line:26,column:1}},line:20},'2':{name:'(anonymous_2)',decl:{start:{line:21,column:31},end:{line:21,column:32}},loc:{start:{line:21,column:57},end:{line:25,column:3}},line:21},'3':{name:'(anonymous_3)',decl:{start:{line:22,column:30},end:{line:22,column:31}},loc:{start:{line:22,column:51},end:{line:24,column:5}},line:22},'4':{name:'(anonymous_4)',decl:{start:{line:28,column:19},end:{line:28,column:20}},loc:{start:{line:28,column:38},end:{line:39,column:1}},line:28},'5':{name:'(anonymous_5)',decl:{start:{line:31,column:31},end:{line:31,column:32}},loc:{start:{line:31,column:57},end:{line:38,column:3}},line:31},'6':{name:'(anonymous_6)',decl:{start:{line:34,column:35},end:{line:34,column:36}},loc:{start:{line:34,column:55},end:{line:37,column:5}},line:34},'7':{name:'(anonymous_7)',decl:{start:{line:41,column:19},end:{line:41,column:20}},loc:{start:{line:41,column:38},end:{line:102,column:1}},line:41},'8':{name:'(anonymous_8)',decl:{start:{line:48,column:11},end:{line:48,column:12}},loc:{start:{line:48,column:23},end:{line:93,column:5}},line:48},'9':{name:'(anonymous_9)',decl:{start:{line:66,column:35},end:{line:66,column:36}},loc:{start:{line:66,column:61},end:{line:91,column:7}},line:66},'10':{name:'(anonymous_10)',decl:{start:{line:67,column:49},end:{line:67,column:50}},loc:{start:{line:67,column:71},end:{line:73,column:9}},line:67},'11':{name:'(anonymous_11)',decl:{start:{line:74,column:92},end:{line:74,column:93}},loc:{start:{line:74,column:105},end:{line:77,column:9}},line:74},'12':{name:'(anonymous_12)',decl:{start:{line:79,column:68},end:{line:79,column:69}},loc:{start:{line:79,column:81},end:{line:82,column:11}},line:79},'13':{name:'(anonymous_13)',decl:{start:{line:85,column:94},end:{line:85,column:95}},loc:{start:{line:85,column:107},end:{line:88,column:11}},line:85},'14':{name:'(anonymous_14)',decl:{start:{line:94,column:12},end:{line:94,column:13}},loc:{start:{line:94,column:19},end:{line:96,column:5}},line:94},'15':{name:'(anonymous_15)',decl:{start:{line:104,column:22},end:{line:104,column:23}},loc:{start:{line:104,column:41},end:{line:118,column:1}},line:104},'16':{name:'(anonymous_16)',decl:{start:{line:107,column:31},end:{line:107,column:32}},loc:{start:{line:107,column:57},end:{line:117,column:3}},line:107},'17':{name:'(anonymous_17)',decl:{start:{line:109,column:45},end:{line:109,column:46}},loc:{start:{line:109,column:67},end:{line:116,column:5}},line:109},'18':{name:'(anonymous_18)',decl:{start:{line:120,column:22},end:{line:120,column:23}},loc:{start:{line:120,column:40},end:{line:136,column:1}},line:120},'19':{name:'(anonymous_19)',decl:{start:{line:124,column:31},end:{line:124,column:32}},loc:{start:{line:124,column:57},end:{line:135,column:3}},line:124},'20':{name:'(anonymous_20)',decl:{start:{line:126,column:94},end:{line:126,column:95}},loc:{start:{line:126,column:116},end:{line:134,column:5}},line:126},'21':{name:'(anonymous_21)',decl:{start:{line:138,column:22},end:{line:138,column:23}},loc:{start:{line:138,column:40},end:{line:144,column:1}},line:138},'22':{name:'(anonymous_22)',decl:{start:{line:139,column:31},end:{line:139,column:32}},loc:{start:{line:139,column:57},end:{line:143,column:3}},line:139},'23':{name:'(anonymous_23)',decl:{start:{line:140,column:30},end:{line:140,column:31}},loc:{start:{line:140,column:51},end:{line:142,column:5}},line:140},'24':{name:'(anonymous_24)',decl:{start:{line:146,column:24},end:{line:146,column:25}},loc:{start:{line:146,column:42},end:{line:152,column:1}},line:146},'25':{name:'(anonymous_25)',decl:{start:{line:147,column:34},end:{line:147,column:35}},loc:{start:{line:147,column:59},end:{line:151,column:3}},line:147},'26':{name:'(anonymous_26)',decl:{start:{line:148,column:30},end:{line:148,column:31}},loc:{start:{line:148,column:50},end:{line:150,column:5}},line:148},'27':{name:'(anonymous_27)',decl:{start:{line:154,column:25},end:{line:154,column:26}},loc:{start:{line:154,column:47},end:{line:161,column:1}},line:154},'28':{name:'(anonymous_28)',decl:{start:{line:155,column:31},end:{line:155,column:32}},loc:{start:{line:155,column:57},end:{line:160,column:3}},line:155},'29':{name:'(anonymous_29)',decl:{start:{line:157,column:35},end:{line:157,column:36}},loc:{start:{line:157,column:55},end:{line:159,column:5}},line:157},'30':{name:'(anonymous_30)',decl:{start:{line:163,column:26},end:{line:163,column:27}},loc:{start:{line:163,column:48},end:{line:179,column:1}},line:163},'31':{name:'(anonymous_31)',decl:{start:{line:165,column:34},end:{line:165,column:35}},loc:{start:{line:165,column:60},end:{line:178,column:3}},line:165},'32':{name:'(anonymous_32)',decl:{start:{line:167,column:35},end:{line:167,column:36}},loc:{start:{line:167,column:55},end:{line:177,column:5}},line:167},'33':{name:'(anonymous_33)',decl:{start:{line:169,column:24},end:{line:169,column:25}},loc:{start:{line:169,column:37},end:{line:171,column:7}},line:169},'34':{name:'(anonymous_34)',decl:{start:{line:172,column:35},end:{line:172,column:36}},loc:{start:{line:172,column:60},end:{line:176,column:7}},line:172},'35':{name:'(anonymous_35)',decl:{start:{line:173,column:57},end:{line:173,column:58}},loc:{start:{line:173,column:77},end:{line:175,column:9}},line:173},'36':{name:'(anonymous_36)',decl:{start:{line:181,column:22},end:{line:181,column:23}},loc:{start:{line:181,column:40},end:{line:190,column:1}},line:181},'37':{name:'(anonymous_37)',decl:{start:{line:182,column:34},end:{line:182,column:35}},loc:{start:{line:182,column:59},end:{line:189,column:3}},line:182},'38':{name:'(anonymous_38)',decl:{start:{line:183,column:50},end:{line:183,column:51}},loc:{start:{line:183,column:72},end:{line:188,column:7}},line:183},'39':{name:'(anonymous_39)',decl:{start:{line:192,column:24},end:{line:192,column:25}},loc:{start:{line:192,column:42},end:{line:202,column:1}},line:192},'40':{name:'(anonymous_40)',decl:{start:{line:193,column:31},end:{line:193,column:32}},loc:{start:{line:193,column:56},end:{line:201,column:3}},line:193},'41':{name:'(anonymous_41)',decl:{start:{line:195,column:68},end:{line:195,column:69}},loc:{start:{line:195,column:89},end:{line:200,column:5}},line:195},'42':{name:'(anonymous_42)',decl:{start:{line:204,column:24},end:{line:204,column:25}},loc:{start:{line:204,column:42},end:{line:214,column:1}},line:204},'43':{name:'(anonymous_43)',decl:{start:{line:205,column:31},end:{line:205,column:32}},loc:{start:{line:205,column:56},end:{line:213,column:3}},line:205},'44':{name:'(anonymous_44)',decl:{start:{line:207,column:69},end:{line:207,column:70}},loc:{start:{line:207,column:90},end:{line:212,column:5}},line:207},'45':{name:'(anonymous_45)',decl:{start:{line:216,column:26},end:{line:216,column:27}},loc:{start:{line:216,column:44},end:{line:226,column:1}},line:216},'46':{name:'(anonymous_46)',decl:{start:{line:217,column:31},end:{line:217,column:32}},loc:{start:{line:217,column:56},end:{line:225,column:3}},line:217},'47':{name:'(anonymous_47)',decl:{start:{line:219,column:70},end:{line:219,column:71}},loc:{start:{line:219,column:91},end:{line:224,column:5}},line:219}},branchMap:{'0':{loc:{start:{line:12,column:2},end:{line:17,column:3}},type:'if',locations:[{start:{line:12,column:2},end:{line:17,column:3}},{start:{line:12,column:2},end:{line:17,column:3}}],line:12},'1':{loc:{start:{line:46,column:2},end:{line:100,column:3}},type:'if',locations:[{start:{line:46,column:2},end:{line:100,column:3}},{start:{line:46,column:2},end:{line:100,column:3}}],line:46},'2':{loc:{start:{line:68,column:10},end:{line:72,column:11}},type:'if',locations:[{start:{line:68,column:10},end:{line:72,column:11}},{start:{line:68,column:10},end:{line:72,column:11}}],line:68},'3':{loc:{start:{line:75,column:10},end:{line:76,column:22}},type:'if',locations:[{start:{line:75,column:10},end:{line:76,column:22}},{start:{line:75,column:10},end:{line:76,column:22}}],line:75},'4':{loc:{start:{line:78,column:8},end:{line:83,column:9}},type:'if',locations:[{start:{line:78,column:8},end:{line:83,column:9}},{start:{line:78,column:8},end:{line:83,column:9}}],line:78},'5':{loc:{start:{line:80,column:12},end:{line:81,column:47}},type:'if',locations:[{start:{line:80,column:12},end:{line:81,column:47}},{start:{line:80,column:12},end:{line:81,column:47}}],line:80},'6':{loc:{start:{line:84,column:8},end:{line:89,column:9}},type:'if',locations:[{start:{line:84,column:8},end:{line:89,column:9}},{start:{line:84,column:8},end:{line:89,column:9}}],line:84},'7':{loc:{start:{line:86,column:12},end:{line:87,column:24}},type:'if',locations:[{start:{line:86,column:12},end:{line:87,column:24}},{start:{line:86,column:12},end:{line:87,column:24}}],line:86},'8':{loc:{start:{line:110,column:6},end:{line:115,column:7}},type:'if',locations:[{start:{line:110,column:6},end:{line:115,column:7}},{start:{line:110,column:6},end:{line:115,column:7}}],line:110},'9':{loc:{start:{line:127,column:6},end:{line:133,column:7}},type:'if',locations:[{start:{line:127,column:6},end:{line:133,column:7}},{start:{line:127,column:6},end:{line:133,column:7}}],line:127},'10':{loc:{start:{line:184,column:8},end:{line:187,column:31}},type:'if',locations:[{start:{line:184,column:8},end:{line:187,column:31}},{start:{line:184,column:8},end:{line:187,column:31}}],line:184},'11':{loc:{start:{line:196,column:6},end:{line:199,column:21}},type:'if',locations:[{start:{line:196,column:6},end:{line:199,column:21}},{start:{line:196,column:6},end:{line:199,column:21}}],line:196},'12':{loc:{start:{line:208,column:6},end:{line:211,column:21}},type:'if',locations:[{start:{line:208,column:6},end:{line:211,column:21}},{start:{line:208,column:6},end:{line:211,column:21}}],line:208},'13':{loc:{start:{line:220,column:6},end:{line:223,column:21}},type:'if',locations:[{start:{line:220,column:6},end:{line:223,column:21}},{start:{line:220,column:6},end:{line:223,column:21}}],line:220}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0,'116':0,'117':0,'118':0,'119':0,'120':0,'121':0,'122':0,'123':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0],'11':[0,0],'12':[0,0],'13':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();// Imports
var mongo=(cov_2pxjvq39wa.s[0]++,require('mongodb'));var mm=(cov_2pxjvq39wa.s[1]++,require('music-metadata'));var fs=(cov_2pxjvq39wa.s[2]++,require('fs'));var Server=(cov_2pxjvq39wa.s[3]++,mongo.Server),Db=(cov_2pxjvq39wa.s[4]++,mongo.Db),MongoClient=(cov_2pxjvq39wa.s[5]++,mongo.MongoClient),database;cov_2pxjvq39wa.s[6]++;MongoClient.connect("mongodb://localhost:27017",{useNewUrlParser:true,auto_reconnect:true},function(err,db){cov_2pxjvq39wa.f[0]++;cov_2pxjvq39wa.s[7]++;if(err){cov_2pxjvq39wa.b[0][0]++;cov_2pxjvq39wa.s[8]++;console.error(err.message);}else{cov_2pxjvq39wa.b[0][1]++;cov_2pxjvq39wa.s[9]++;database=db.db("mp3");}});cov_2pxjvq39wa.s[10]++;exports.findAll=function(req,res){cov_2pxjvq39wa.f[1]++;cov_2pxjvq39wa.s[11]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[2]++;cov_2pxjvq39wa.s[12]++;collection.find().toArray(function(err,items){cov_2pxjvq39wa.f[3]++;cov_2pxjvq39wa.s[13]++;res.send(items);});});};cov_2pxjvq39wa.s[14]++;exports.findById=function(req,res){cov_2pxjvq39wa.f[4]++;var id=(cov_2pxjvq39wa.s[15]++,req.params.id);cov_2pxjvq39wa.s[16]++;console.log('Retrieving plage: '+id);cov_2pxjvq39wa.s[17]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[5]++;// necessaire d'utiliser l'objectID pour requêter la base avec l'id
var query=(cov_2pxjvq39wa.s[18]++,{"_id":new mongo.ObjectID(id)});cov_2pxjvq39wa.s[19]++;collection.find(query).toArray(function(err,item){cov_2pxjvq39wa.f[6]++;cov_2pxjvq39wa.s[20]++;console.log(item);cov_2pxjvq39wa.s[21]++;res.send(item);});});};cov_2pxjvq39wa.s[22]++;exports.addPlage=function(req,res){cov_2pxjvq39wa.f[7]++;// console.log('Adding plage: ' + JSON.stringify(plage));
var path=(cov_2pxjvq39wa.s[23]++,req.body.name);var name=(cov_2pxjvq39wa.s[24]++,path.substring(5));var pochette=(cov_2pxjvq39wa.s[25]++,req.files.pochette);cov_2pxjvq39wa.s[26]++;if(fs.existsSync(appRoot+"/files"+path+".mp3")){cov_2pxjvq39wa.b[1][0]++;cov_2pxjvq39wa.s[27]++;mm.parseFile(appRoot+"/files"+path+".mp3",{native:true}).then(metadata=>{cov_2pxjvq39wa.f[8]++;var content=(cov_2pxjvq39wa.s[28]++,fs.readFileSync(appRoot+"/files"+path+".json"));// à modifier pour que le chemin soit dynamique. récupère le contenu du fichier JSON
// création de l'objet à insérer dans la base
var nomFichierFinal=(cov_2pxjvq39wa.s[29]++,req.body.nomPlage+req.body.nomArtiste+metadata.format.duration);cov_2pxjvq39wa.s[30]++;nomFichierFinal=nomFichierFinal.replace(/\s/g,'');var plage=(cov_2pxjvq39wa.s[31]++,{"nomPlage":req.body.nomPlage,"nomArtiste":req.body.nomArtiste,"nomAlbum":req.body.nomAlbum,"featArtiste":req.body.featArtiste,"duree":metadata.format.duration,"nbEcoutes":0,"nbLikes":0,"dateAjout":new Date(),"dataJSON":JSON.parse(""+content).data,"cheminMP3":"mp3/"+nomFichierFinal+".mp3","cheminPochette":"art/"+nomFichierFinal+".jpg"});cov_2pxjvq39wa.s[32]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[9]++;cov_2pxjvq39wa.s[33]++;collection.insertOne(plage,{safe:true},function(err,result){cov_2pxjvq39wa.f[10]++;cov_2pxjvq39wa.s[34]++;if(err){cov_2pxjvq39wa.b[2][0]++;cov_2pxjvq39wa.s[35]++;res.send({'error':'An error has occurred'});}else{cov_2pxjvq39wa.b[2][1]++;cov_2pxjvq39wa.s[36]++;res.send("Success!");}});cov_2pxjvq39wa.s[37]++;fs.rename(appRoot+"/files"+path+".mp3",appRoot+"/files/mp3/"+nomFichierFinal+".mp3",function(err){cov_2pxjvq39wa.f[11]++;cov_2pxjvq39wa.s[38]++;if(err){cov_2pxjvq39wa.b[3][0]++;cov_2pxjvq39wa.s[39]++;throw err;}else{cov_2pxjvq39wa.b[3][1]++;}});cov_2pxjvq39wa.s[40]++;if(pochette!==undefined){cov_2pxjvq39wa.b[4][0]++;cov_2pxjvq39wa.s[41]++;pochette.mv(appRoot+"/files/art/"+nomFichierFinal+".jpg",function(err){cov_2pxjvq39wa.f[12]++;cov_2pxjvq39wa.s[42]++;if(err){cov_2pxjvq39wa.b[5][0]++;cov_2pxjvq39wa.s[43]++;return res.status(500).send(err);}else{cov_2pxjvq39wa.b[5][1]++;}});}else{cov_2pxjvq39wa.b[4][1]++;}cov_2pxjvq39wa.s[44]++;if(fs.existsSync(appRoot+"/files"+path+".jpg")){cov_2pxjvq39wa.b[6][0]++;cov_2pxjvq39wa.s[45]++;fs.rename(appRoot+"/files"+path+".jpg",appRoot+"/files/art/"+nomFichierFinal+".jpg",function(err){cov_2pxjvq39wa.f[13]++;cov_2pxjvq39wa.s[46]++;if(err){cov_2pxjvq39wa.b[7][0]++;cov_2pxjvq39wa.s[47]++;throw err;}else{cov_2pxjvq39wa.b[7][1]++;}});}else{cov_2pxjvq39wa.b[6][1]++;}cov_2pxjvq39wa.s[48]++;fs.unlinkSync(appRoot+"/files"+path+".json");});}).catch(err=>{cov_2pxjvq39wa.f[14]++;cov_2pxjvq39wa.s[49]++;console.error(err.message);});}else{cov_2pxjvq39wa.b[1][1]++;cov_2pxjvq39wa.s[50]++;res.send("Valeur incorrecte dans le formulaire");}};cov_2pxjvq39wa.s[51]++;exports.deletePlage=function(req,res){cov_2pxjvq39wa.f[15]++;var id=(cov_2pxjvq39wa.s[52]++,req.params.id);cov_2pxjvq39wa.s[53]++;console.log('Deleting plage: '+id);cov_2pxjvq39wa.s[54]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[16]++;var query=(cov_2pxjvq39wa.s[55]++,{"_id":new mongo.ObjectID(id)});cov_2pxjvq39wa.s[56]++;collection.deleteOne(query,{safe:true},function(err,result){cov_2pxjvq39wa.f[17]++;cov_2pxjvq39wa.s[57]++;if(err){cov_2pxjvq39wa.b[8][0]++;cov_2pxjvq39wa.s[58]++;res.send({'error':'An error has occurred - '+err});}else{cov_2pxjvq39wa.b[8][1]++;cov_2pxjvq39wa.s[59]++;console.log(''+result+' document(s) deleted');cov_2pxjvq39wa.s[60]++;res.send(req.body);}});});};cov_2pxjvq39wa.s[61]++;exports.updatePlage=function(req,res){cov_2pxjvq39wa.f[18]++;var id=(cov_2pxjvq39wa.s[62]++,req.params.id);var plage=(cov_2pxjvq39wa.s[63]++,req.body);cov_2pxjvq39wa.s[64]++;console.log('Updating plage: '+id);cov_2pxjvq39wa.s[65]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[19]++;var query=(cov_2pxjvq39wa.s[66]++,{"_id":new mongo.ObjectID(id)});cov_2pxjvq39wa.s[67]++;collection.updateOne(query,{$set:plage,$currentDate:{lastModified:true}},{safe:true},function(err,result){cov_2pxjvq39wa.f[20]++;cov_2pxjvq39wa.s[68]++;if(err){cov_2pxjvq39wa.b[9][0]++;cov_2pxjvq39wa.s[69]++;console.log('Error updating plage: '+err);cov_2pxjvq39wa.s[70]++;res.send({'error':'An error has occurred'});}else{cov_2pxjvq39wa.b[9][1]++;cov_2pxjvq39wa.s[71]++;console.log(''+result+' document(s) updated');cov_2pxjvq39wa.s[72]++;res.send(plage);}});});};cov_2pxjvq39wa.s[73]++;exports.listePlages=function(callback){cov_2pxjvq39wa.f[21]++;cov_2pxjvq39wa.s[74]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[22]++;cov_2pxjvq39wa.s[75]++;collection.find().toArray(function(err,items){cov_2pxjvq39wa.f[23]++;cov_2pxjvq39wa.s[76]++;callback(items);});});};cov_2pxjvq39wa.s[77]++;exports.listePlaylist=function(callback){cov_2pxjvq39wa.f[24]++;cov_2pxjvq39wa.s[78]++;database.collection('playlist',function(err,collection){cov_2pxjvq39wa.f[25]++;cov_2pxjvq39wa.s[79]++;collection.find().toArray(function(err,items){cov_2pxjvq39wa.f[26]++;cov_2pxjvq39wa.s[80]++;callback(items);});});};cov_2pxjvq39wa.s[81]++;exports.lecteurMusique=function(id,callback){cov_2pxjvq39wa.f[27]++;cov_2pxjvq39wa.s[82]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[28]++;var query=(cov_2pxjvq39wa.s[83]++,{"_id":new mongo.ObjectID(id)});cov_2pxjvq39wa.s[84]++;collection.find(query).toArray(function(err,item){cov_2pxjvq39wa.f[29]++;cov_2pxjvq39wa.s[85]++;callback(item);});});};cov_2pxjvq39wa.s[86]++;exports.lecteurPlaylist=function(id,callback){cov_2pxjvq39wa.f[30]++;var tabIds=(cov_2pxjvq39wa.s[87]++,[]);cov_2pxjvq39wa.s[88]++;database.collection('playlist',function(err,collection){cov_2pxjvq39wa.f[31]++;var query=(cov_2pxjvq39wa.s[89]++,{"_id":new mongo.ObjectID(id)});cov_2pxjvq39wa.s[90]++;collection.find(query).toArray(function(err,item){cov_2pxjvq39wa.f[32]++;cov_2pxjvq39wa.s[91]++;tabIds=item[0].ids.split(",");cov_2pxjvq39wa.s[92]++;tabIds=tabIds.map(function(row){cov_2pxjvq39wa.f[33]++;cov_2pxjvq39wa.s[93]++;return mongo.ObjectID(row);});cov_2pxjvq39wa.s[94]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[34]++;cov_2pxjvq39wa.s[95]++;collection.find({"_id":{"$in":tabIds}}).toArray(function(err,items){cov_2pxjvq39wa.f[35]++;cov_2pxjvq39wa.s[96]++;callback(items);});});});});};cov_2pxjvq39wa.s[97]++;exports.addPlaylist=function(req,res){cov_2pxjvq39wa.f[36]++;cov_2pxjvq39wa.s[98]++;database.collection('playlist',function(err,collection){cov_2pxjvq39wa.f[37]++;cov_2pxjvq39wa.s[99]++;collection.insertOne(req.body,{safe:true},function(err,result){cov_2pxjvq39wa.f[38]++;cov_2pxjvq39wa.s[100]++;if(err){cov_2pxjvq39wa.b[10][0]++;cov_2pxjvq39wa.s[101]++;res.send({'error':'An error has occurred'});}else{cov_2pxjvq39wa.b[10][1]++;cov_2pxjvq39wa.s[102]++;res.send("Success!");}});});};cov_2pxjvq39wa.s[103]++;exports.likeIncrement=function(req,res){cov_2pxjvq39wa.f[39]++;cov_2pxjvq39wa.s[104]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[40]++;var query=(cov_2pxjvq39wa.s[105]++,{"_id":new mongo.ObjectID(req.params.id)});cov_2pxjvq39wa.s[106]++;collection.updateOne(query,{$inc:{'nbLikes':1}},{safe:true},function(err,result){cov_2pxjvq39wa.f[41]++;cov_2pxjvq39wa.s[107]++;if(err){cov_2pxjvq39wa.b[11][0]++;cov_2pxjvq39wa.s[108]++;console.log(err);}else{cov_2pxjvq39wa.b[11][1]++;cov_2pxjvq39wa.s[109]++;res.send("");}});});};cov_2pxjvq39wa.s[110]++;exports.likeDecrement=function(req,res){cov_2pxjvq39wa.f[42]++;cov_2pxjvq39wa.s[111]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[43]++;var query=(cov_2pxjvq39wa.s[112]++,{"_id":new mongo.ObjectID(req.params.id)});cov_2pxjvq39wa.s[113]++;collection.updateOne(query,{$inc:{'nbLikes':-1}},{safe:true},function(err,result){cov_2pxjvq39wa.f[44]++;cov_2pxjvq39wa.s[114]++;if(err){cov_2pxjvq39wa.b[12][0]++;cov_2pxjvq39wa.s[115]++;console.log(err);}else{cov_2pxjvq39wa.b[12][1]++;cov_2pxjvq39wa.s[116]++;res.send("");}});});};cov_2pxjvq39wa.s[117]++;exports.listenIncrement=function(req,res){cov_2pxjvq39wa.f[45]++;cov_2pxjvq39wa.s[118]++;database.collection('plage',function(err,collection){cov_2pxjvq39wa.f[46]++;var query=(cov_2pxjvq39wa.s[119]++,{"_id":new mongo.ObjectID(req.params.id)});cov_2pxjvq39wa.s[120]++;collection.updateOne(query,{$inc:{'nbEcoutes':1}},{safe:true},function(err,result){cov_2pxjvq39wa.f[47]++;cov_2pxjvq39wa.s[121]++;if(err){cov_2pxjvq39wa.b[13][0]++;cov_2pxjvq39wa.s[122]++;console.log(err);}else{cov_2pxjvq39wa.b[13][1]++;cov_2pxjvq39wa.s[123]++;res.send("");}});});};